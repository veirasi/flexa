<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Flexa - App</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
   <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        /* ESTILOS ORIGINAIS MANTIDOS */
        :root {
            --brand-orange: #f58220;
            --brand-orange-hover: #e67616;
            --bg-page: #f8fafc;
            --card-white: #ffffff;
            --text-main: #0f172a;
            --text-sub: #94a3b8;
            --border-color: #f1f5f9;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: var(--bg-page); display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; color: var(--text-main); overflow-x: hidden; position: relative; }

        .bg-sphere { position: fixed; border-radius: 50%; filter: blur(80px); z-index: -1; opacity: 0.4; animation: float 20s infinite alternate; }
        .sphere-1 { width: 300px; height: 300px; background: var(--brand-orange); top: -100px; right: -100px; }
        .sphere-2 { width: 250px; height: 250px; background: #3b82f6; bottom: -50px; left: -100px; }
        @keyframes float { from { transform: translate(0, 0); } to { transform: translate(-30px, 50px); } }

        .container { width: 100%; max-width: 420px; padding: 40px 25px 100px 25px; position: relative; z-index: 1; }
        .view { display: none !important; width: 100%; animation: slideIn 0.4s ease-out; }
        .view.active { display: block !important; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .skeleton { 
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%) !important; 
            background-size: 200% 100% !important; 
            animation: shimmer 1.5s infinite !important; 
            border-radius: 12px; 
            color: transparent !important;
            border: none !important;
            box-shadow: none !important;
        }
        @keyframes shimmer { from { background-position: -200% 0; } to { background-position: 200% 0; } }

        .welcome-text { text-align: center; margin-bottom: 45px; margin-top: 20px; }
        .welcome-text h1 { font-size: 38px; font-weight: 900; letter-spacing: -2px; margin-bottom: 8px; }
        .welcome-text span { color: var(--brand-orange); }
        
        .option-card { 
            display: flex; align-items: center; padding: 24px; border-radius: 28px; margin-bottom: 20px; 
            cursor: pointer; background: #ffffff; 
            border: 2px solid transparent; box-shadow: 0 10px 25px rgba(15, 23, 42, 0.04); 
            transition: var(--transition); min-height: 140px;
        }
        .option-card:hover { transform: translateY(-5px) scale(1.02); border-color: var(--brand-orange); }
        
        .icon-box { width: 64px; height: 64px; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 20px; flex-shrink: 0; }
        .card-loja .icon-box { background: #fff7ed; color: var(--brand-orange); }
        .card-entrega .icon-box { background: #eff6ff; color: #3b82f6; }
        .badge-card { font-size: 10px; font-weight: 800; text-transform: uppercase; padding: 4px 10px; border-radius: 20px; background: #f1f5f9; color: var(--text-sub); }

        .auth-card { background: var(--card-white); padding: 35px 25px; border-radius: 32px; border: 1px solid var(--border-color); box-shadow: 0 10px 30px rgba(15, 23, 42, 0.04); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-size: 13px; font-weight: 700; margin-bottom: 12px; color: var(--text-main); }
        .input-wrapper { display: flex; align-items: center; background: #ffffff; border: 1.5px solid #f1f5f9; border-radius: 16px; padding: 0 18px; gap: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.02); }
        input { flex: 1; min-width: 0; padding: 18px 0; background: transparent; border: none; color: var(--text-main); outline: none; font-size: 16px; }
        .btn-main { width: 100%; background: var(--brand-orange); color: white; border: none; padding: 18px; border-radius: 16px; font-size: 16px; font-weight: 700; cursor: pointer; transition: var(--transition); margin-top: 10px; }

        .tabs { display: flex; background: #f1f5f9; border-radius: 14px; padding: 4px; margin-bottom: 30px; }
        .tab { flex: 1; text-align: center; padding: 10px; cursor: pointer; color: var(--text-sub); font-weight: 600; border-radius: 11px; }
        .tab.active { background: white; color: var(--brand-orange); }

        .header-dash { display: flex; justify-content: space-between; align-items: center; padding-bottom: 25px; }
        .header-dash .logo { font-size: 24px; font-weight: 900; letter-spacing: -1.2px; }
        .header-dash .logo span { color: var(--brand-orange); }
        .profile-img { width: 44px; height: 44px; border-radius: 50%; object-fit: cover; border: 2px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .promo-banner { background: linear-gradient(135deg, #ff9d4d, var(--brand-orange)); border-radius: 28px; padding: 25px; color: white; margin-bottom: 25px; }
        .grid-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .stat-card { background: white; padding: 20px; border-radius: 24px; border: 1px solid var(--border-color); }

        /* MENU INFERIOR SUSPENSO - PRETO E ARREDONDADO */
#main-nav {
    position: fixed;
    bottom: 25px; /* Afastado da base */
    left: 20px;   /* Afastado da esquerda */
    right: 20px;  /* Afastado da direita */
    height: 70px;
    background: #000000; /* Fundo Preto */
    display: none; /* Garanta que o JS mude para flex quando logado */
    align-items: center;
    justify-content: space-around;
    border-radius: 25px; /* Bordas bem arredondadas */
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    padding: 0 10px;
    z-index: 9999;
}

/* √çcones n√£o ativos (Brancos Vazados) */
.nav-item {
    color: #FFFFFF;
    text-decoration: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    opacity: 0.6; /* Efeito de vazado/suave */
    transition: all 0.2s ease;
}

.nav-item i {
    stroke-width: 1.5px; /* Deixa o √≠cone mais fino/vazado */
}

/* √çcone ativo (Branco Preenchido) */
.nav-item.active {
    color: #FFFFFF;
    opacity: 1;
}

.nav-item.active i {
    stroke-width: 2.5px; /* Simula o preenchimento/destaque */
}

.nav-item span {
    font-size: 10px;
    font-weight: 600;
}

/* Bot√£o + Envio em Destaque */
.nav-center-plus {
    background: #FFFFFF; /* Fundo Branco */
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 3px solid var(--brand-orange); /* Borda Laranja */
    transform: translateY(-1px); /* Levemente para cima */
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.nav-center-plus i {
    color: #000000 !important; /* + em Preto */
}


        .hidden { display: none !important; }
        /* ADICIONE ISTO AQUI */
        .filter-container { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 20px; 
            overflow-x: auto; 
            padding-bottom: 5px; 
            -webkit-overflow-scrolling: touch;
        }
        .chip { 
            padding: 8px 18px; 
            border-radius: 20px; 
            background: white; 
            border: 1.5px solid var(--border-color); 
            font-size: 13px; 
            font-weight: 700; 
            color: var(--text-sub); 
            cursor: pointer; 
            white-space: nowrap; 
            transition: var(--transition);
        }
        .chip.active { 
            background: var(--brand-orange); 
            color: white; 
            border-color: var(--brand-orange); 
        }
        /* NOVOS ESTILOS - TELA DE ENVIO (CONFORME PRINTS) */
        .destinatario-card { background: white; padding: 20px; border-radius: 24px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
        .destinatario-label { font-size: 11px; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; display: block; }
        .destinatario-nome { font-size: 18px; font-weight: 800; color: #0f172a; display: block; }
        .destinatario-info { font-size: 14px; color: #64748b; margin-top: 2px; display: block; }

        .section-title { font-size: 15px; font-weight: 800; color: #0f172a; margin-bottom: 15px; display: block; }

        /* Grid de Sele√ß√£o (Servi√ßo e Tamanho) */
        .selection-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .selection-grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 25px; }
        
        .select-box { 
            background: white; border: 2px solid #f1f5f9; border-radius: 20px; padding: 18px 10px; 
            text-align: center; cursor: pointer; transition: var(--transition);
        }
        .select-box.active { border-color: var(--brand-orange); background: #fffaf5; }
        .select-box i { color: #0f172a; margin-bottom: 8px; }
        .select-box strong { display: block; font-size: 15px; font-weight: 800; color: #0f172a; }
        .select-box span { font-size: 11px; color: #94a3b8; font-weight: 600; }

        .info-row { display: flex; gap: 10px; background: #f8fafc; padding: 15px; border-radius: 18px; margin-bottom: 25px; }
        .info-item { flex: 1; text-align: center; }
        .info-item label { display: block; font-size: 10px; font-weight: 800; color: #94a3b8; text-transform: uppercase; margin-bottom: 4px; }
        .info-item p { font-size: 15px; font-weight: 800; color: #0f172a; }

        .btn-outline { 
            width: 100%; background: white; color: #0f172a; border: 1.5px solid #f1f5f9; 
            padding: 16px; border-radius: 18px; font-size: 15px; font-weight: 800; cursor: pointer; margin-top: 10px;
        }

        .cliente-card-simples { 
            background: white; padding: 20px; border-radius: 24px; margin-bottom: 12px; 
            border: 1.5px solid #f1f5f9; position: relative; cursor: pointer;
        }
        .badge-freq { position: absolute; top: 15px; right: 20px; background: #ecfdf5; color: #10b981; font-size: 10px; font-weight: 800; padding: 4px 10px; border-radius: 10px; }

        /* ESTILOS DO CARD DE ROTA ATIVA */
        .rota-card { 
            background: white; 
            padding: 20px; 
            border-radius: 24px; 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            border: 1px solid var(--border-color); 
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            margin-top: 10px;
        }
        .rota-icon { 
            width: 48px; 
            height: 48px; 
            background: #f8fafc; 
            border-radius: 16px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: var(--brand-orange); 
        }
        .rota-info { flex: 1; }
        .rota-info h5 { font-size: 15px; font-weight: 800; color: #0f172a; margin-bottom: 2px; }
        .rota-info p { font-size: 13px; color: #64748b; font-weight: 600; }
        
        .status-pill { 
            font-size: 10px; 
            font-weight: 900; 
            padding: 6px 12px; 
            border-radius: 12px; 
            text-transform: uppercase; 
        }
        .pill-em-rota { background: #ecfdf5; color: #10b981; }
      /* Anima√ß√£o suave para troca de passos internos */
.fade-step {
    animation: fadeStep 0.35s ease-out;
}

@keyframes fadeStep {
    from { opacity: 0; transform: translateX(10px); }
    to { opacity: 1; transform: translateX(0); }
}

 /* Ajuste para que o grid de 2 colunas n√£o estique os cards */
.selection-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* For√ßamos a base de 3 colunas para alinhar com o de baixo */
    gap: 12px;
    margin-bottom: 25px;
}

/* Padroniza√ß√£o do tamanho dos boxes */
.select-box {
    background: white;
    border: 2px solid #f1f5f9;
    border-radius: 20px;
    padding: 12px 5px; /* Reduzi o padding vertical para ficarem mais baixos */
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 85px; /* Altura fixa para garantir harmonia entre todos */
}

/* Ajuste dos √≠cones dentro dos boxes para n√£o empurrarem muito o texto */
.select-box i {
    margin-bottom: 5px;
    width: 20px;
    height: 20px;
}       
                      /* --- DESIGN DO SWIPE E DESFAZER (VERS√ÉO FINAL) --- */
        .swipe-container {
            position: relative;
            overflow: hidden;
            border-radius: 18px;
            margin-bottom: 12px;
            background-color: #ef4444; 
            touch-action: pan-y;
        }

        .swipe-action-delete {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            flex-direction: column;
            gap: 4px;
            z-index: 1;
            border-radius: 0 18px 18px 0; 
        }

        .cliente-card-simples {
            position: relative;
            z-index: 2;
            margin-bottom: 0 !important;
            border: none !important;
            border-radius: 18px;
            background: white;
            width: 100.2%;
            left: -0.1%;
        }

                /* AVISO MELHORADO: TODO CLIC√ÅVEL E COM CONTADOR */
        .undo-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            z-index: 99999;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 380px;
            cursor: pointer; /* Indica que √© clic√°vel */
            animation: slideUpToast 0.3s ease-out;
            user-select: none;
        }

        .undo-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-grow: 1;
        }

        .undo-btn { 
            color: var(--brand-orange); 
            font-weight: 800; 
            text-transform: uppercase;
            font-size: 13px;
            padding-right: 5px;
        }

        /* O CONTADOR (C√çRCULO) */
        .undo-timer {
            width: 24px;
            height: 24px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            color: var(--brand-orange);
            border: 2px solid rgba(245, 130, 32, 0.3);
        }

        @keyframes slideUpToast {
            from { bottom: -100px; opacity: 0; }
            to { bottom: 30px; opacity: 1; }
        }

.veiculo-item {
    display: flex;
    align-items: center;
    padding: 16px;
    background: white;
    border: 2px solid #f1f5f9;
    border-radius: 20px;
    cursor: pointer;
    transition: var(--transition);
}

.veiculo-item.active {
    border-color: var(--brand-orange);
    background: #fffaf5;
}

.veiculo-icon {
    width: 45px;
    height: 45px;
    background: #f8fafc;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-main);
    margin-right: 15px;
}

.veiculo-item.active .veiculo-icon {
    background: var(--brand-orange);
    color: white;
}

.veiculo-info {
    flex: 1;
}

.veiculo-info strong {
    display: block;
    font-size: 15px;
    color: var(--text-main);
}

.veiculo-info span {
    font-size: 12px;
    color: var(--text-sub);
}

.veiculo-preco {
    font-size: 16px;
    font-weight: 800;
    color: var(--text-main);
}

.checkbox-envio {
    background: white; border: 2px solid #f1f5f9; padding: 16px; border-radius: 20px;
    display: flex; align-items: center; gap: 12px; cursor: pointer; transition: var(--transition);
}
.checkbox-envio.selected { border-color: var(--brand-orange); background: #fffaf5; }
.badge-flash { background: #fee2e2; color: #ef4444; font-size: 10px; padding: 2px 8px; border-radius: 8px; font-weight: 800; }

.header-perfil { padding: 20px; text-align: center; border-bottom: 1px solid #eee; }
.perfil-container { padding: 20px; }

.logo-upload-section { text-align: center; margin-bottom: 30px; }
.logo-wrapper { 
    width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--brand-orange);
    margin: 0 auto 15px; position: relative; overflow: hidden; cursor: pointer;
}
.logo-wrapper img { width: 100%; height: 100%; object-fit: cover; }
.edit-overlay { 
    position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.5); 
    color: white; padding: 5px 0; font-size: 10px;
}

.perfil-menu { display: flex; flex-direction: column; gap: 15px; }
.menu-item { 
    display: flex; align-items: center; padding: 15px; background: #f9f9f9; 
    border-radius: 12px; transition: 0.2s; cursor: pointer;
}
.menu-item:active { transform: scale(0.98); background: #f0f0f0; }
.menu-icon { width: 40px; color: var(--brand-orange); }
.menu-text { flex: 1; display: flex; flex-direction: column; }
.menu-text strong { font-size: 14px; }
.menu-text span { font-size: 12px; color: #888; }

.btn-logout { 
    /* Seus estilos originais mantidos */
    margin-top: 20px; 
    background: #fff; 
    color: #ff4444; 
    border: 1px solid #ff4444;
    padding: 15px; 
    border-radius: 12px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    gap: 10px; 
    font-weight: 700;
    
    /* Adi√ß√µes para funcionalidade e toque */
    cursor: pointer;
    transition: var(--transition);
}

/* Adicione este bloco novo logo abaixo para o efeito visual ao passar o mouse */
.btn-logout:hover {
    background: #fff5f5;
    transform: translateY(-2px);
}


/* --- TELA PERFIL FLEXA (REFEITA) --- */

#view-perfil {
    padding: 0 0 120px 0 !important;
    background-color: transparent !important; /* Mostra o fundo do projeto */
}

/* Ponto 1: Foto, Nome e @ */

.perfil-header {
    text-align: center;
    padding: 40px 10px 40px; /* Reduzi padding lateral */
    background: transparent !important; 
}

.avatar-wrapper {
    position: relative;
    width: 110px;
    height: 110px;
    margin: 0 auto 15px;
}

.avatar-wrapper img {
    width: 100%;
    height: 100%;
    border-radius: 50% !important; /* Circular */
    object-fit: cover;
    border: 4px solid #fff;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.btn-edit-photo {
    position: absolute;
    bottom: 2px;
    right: 2px;
    background: var(--brand-orange);
    color: white;
    width: 34px;
    height: 34px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 3px solid white;
    cursor: pointer;
}

.user-name { font-size: 22px; font-weight: 800; color: #000; margin-bottom: 2px; }
.user-instagram { font-size: 14px; color: var(--text-sub); font-weight: 500; }

/* Ponto 2: Se√ß√µes e Cards Arredondados */

.perfil-content { 
    padding: 0 8px; 
    margin-top: 20px;

/* Espa√ßo m√≠nimo nas laterais para encostar mais */
}

.perfil-section { 
    margin-top: 10px;
    margin-bottom: 35px; /* Aumentado para descolar o t√≠tulo da se√ß√£o seguinte */
}

.section-label {
    font-size: 12px;
    text-transform: uppercase;
    color: #000;
    font-weight: 900;
    margin-bottom: 12px;
    padding-left: 12px;
    display: block;
    margin-top: 5px;
}

.menu-group {
    background: #f8fafc;
    border-radius: 20px; 
    overflow: hidden;
    border: 1px solid #eee;
    box-shadow: 0 2px 8px rgba(0,0,0,0.02);
    width: 100%; /* Garante largura total dentro do container */
}

.menu-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 20px;
    border-bottom: 1px solid #f1f5f9;
    cursor: pointer;
}

.menu-item:last-child { border-bottom: none; }

/* Ponto 4: Alinhamento Perfeito */
.item-left { display: flex; align-items: center; gap: 15px; }
.item-left i { 
    color: #000; 
    width: 24px; 
    display: flex; 
    justify-content: center; 
}
.item-left span { font-size: 15px; font-weight: 600; color: #000; }
.arrow { color: #cbd5e1; }

/* Ponto 3: Bot√£o Logout (Dentro do Fluxo) */

.perfil-footer { 
    padding: 0 2px; /* Mesma folga lateral dos cards (.perfil-content) */
    margin-top: 10px;
    margin-bottom: 30px; /* Garante que n√£o fique colado na tab bar */
}

.btn-logout {
    width: 100%; /* Agora ocupa exatamente a mesma largura dos cards acima */
    padding: 18px;
    background: #fee2e2;
    border: 1px solid #fee2e2;
    border-radius: 20px;
    color: #ef4444;
    font-size: 16px;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    cursor: pointer;
    box-sizing: border-box; /* Garante que o padding n√£o estoure a largura */
}


/* Adicione isso ao final do seu <style> */
.modal-sheet.show { transform: translateY(0) !important; }
/* Container que permite o alinhamento total */
.filter-container {
    width: 100%;
    overflow: hidden; /* Esconde o que sobrar */
    padding: 10px 0 20px 0;
}

/* A linha de bot√µes que desliza */
.filter-scroll {
    display: flex;
    gap: 12px;
    overflow-x: auto; /* Ativa o scroll horizontal */
    padding: 0 5px; /* Pequeno respiro nas laterais */
    
    /* Remove as barras de rolagem vis√≠veis para ficar limpo */
    scrollbar-width: none; 
    -webkit-overflow-scrolling: touch; 
}

.filter-scroll::-webkit-scrollbar {
    display: none;
}

/* O Chip (Bot√£o) */
.chip {
    flex-shrink: 0; /* CRUCIAL: impede o bot√£o de amassar no mobile */
    white-space: nowrap; /* Impede o texto de quebrar linha */
    padding: 10px 20px;
    background: white;
    border-radius: 100px;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-sub);
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.03);
    border: 1px solid #f1f5f9;
}

/* Mant√©m o destaque do primeiro bot√£o como no seu c√≥digo */
.chip.active {
    background: var(--dark);
    color: white;
}

/* ESTILOS DA TELA DE SPLASH */
#splash-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #ffffff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 20000; /* Fica acima de tudo */
    transition: opacity 0.5s ease;
}

.logo-splash {
    width: 160px; /* Ajuste o tamanho conforme desejar */
    height: auto;
    margin-bottom: 30px;
    animation: fadeInScale 0.8s ease-out forwards, pulse 2s infinite ease-in-out 0.8s;
    opacity: 0;
}

.loader-splash {
    width: 35px;
    height: 35px;
    border: 3px solid #f1f5f9;
    border-top: 3px solid var(--brand-orange);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* ANIMA√á√ïES */
@keyframes fadeInScale {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

 </style>
</head>
<body>

<div id="splash-screen">
    <img src="img/logo.svg" alt="Flexa Logo" class="logo-splash">
    
</div>

    <div class="bg-sphere sphere-1"></div>
    <div class="bg-sphere sphere-2"></div>

    <div class="container">
        
        <section id="view-inicio" class="view">
            <div class="welcome-text">
                <h1>FLEX<span>A</span></h1>
                <p>O futuro da sua log√≠stica est√° aqui.</p>
            </div>
            <div class="option-card card-loja" onclick="irParaCadastro('loja')">
                <div class="icon-box"><i data-lucide="store" size="32"></i></div>
                <div class="content">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
                        <h2 style="font-size:18px; font-weight:700;">Enviar pacotes</h2>
                        <span class="badge-card">Neg√≥cios</span>
                    </div>
                    <p style="font-size:14px; color:var(--text-sub);">Solu√ß√µes inteligentes para expandir sua loja e entregas.</p>
                </div>
            </div>
            <div class="option-card card-entrega" onclick="irParaCadastro('entrega')">
                <div class="icon-box"><i data-lucide="truck" size="32"></i></div>
                <div class="content">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
                        <h2 style="font-size:18px; font-weight:700;">Fazer entregas</h2>
                        <span class="badge-card">Parceiro</span>
                    </div>
                    <p style="font-size:14px; color:var(--text-sub);">Fa√ßa seu pr√≥prio hor√°rio e aumente sua renda di√°ria.</p>
                </div>
            </div>
        </section>

        <section id="view-auth" class="view">
            <div class="auth-card">
                <div style="text-align: center; margin-bottom: 30px; font-size: 34px; font-weight: 900; letter-spacing: -1.5px; cursor: pointer;" onclick="navegar('view-inicio')">FLEX<span>A</span></div>
                <div class="tabs">
                    <div id="tab-entrar" class="tab active" onclick="alternarAuth('entrar')">Entrar</div>
                    <div id="tab-cadastrar" class="tab" onclick="alternarAuth('cadastrar')">Cadastre-se</div>
                </div>

                <form id="form-entrar">
                    <div class="form-group"><label>E-mail</label><div class="input-wrapper"><i data-lucide="mail" size="20"></i><input type="email" placeholder="Login de acesso"></div></div>
                    <div class="form-group"><label>Senha</label><div class="input-wrapper"><i data-lucide="lock" size="20"></i><input type="password" id="pass-login" placeholder="Sua senha"><i data-lucide="eye" size="20" style="cursor:pointer; color:var(--text-sub);" onclick="togglePass('pass-login')"></i></div></div>
                    <button type="button" class="btn-main" onclick="loginReal()">Entrar na Flexa</button>
                    <p style="text-align:center; margin-top:20px; font-size:14px; color:var(--brand-orange); font-weight:600; cursor:pointer;" onclick="navegar('view-recuperar')">Esqueci minha senha</p>
                </form>

                <form id="form-cadastrar" class="hidden">
                    <div class="form-group"><label id="label-nome">Nome da loja</label><div class="input-wrapper"><i data-lucide="user" size="20"></i><input type="text" id="input-nome" placeholder="Digite o nome da loja"></div></div>
                    <div id="group-cnh" class="form-group hidden"><label>N√∫mero CNH</label><div class="input-wrapper"><i data-lucide="file-text" size="20"></i><input type="text" placeholder="000.000.000-00"></div></div>
                    <div class="form-group"><label>E-mail</label><div class="input-wrapper"><i data-lucide="mail" size="20"></i><input type="email" placeholder="contato@exemplo.com"></div></div>
                    <div class="form-group"><label>Senha</label><div class="input-wrapper"><i data-lucide="lock" size="20"></i><input type="password" id="pass-cad" placeholder="M√≠nimo 6 caracteres"><i data-lucide="eye" size="20" style="cursor:pointer; color:var(--text-sub);" onclick="togglePass('pass-cad')"></i></div></div>
                    <div class="form-group"><label>Confirmar Senha</label><div class="input-wrapper"><i data-lucide="lock" size="20"></i><input type="password" id="pass-conf" placeholder="Repita a senha"><i data-lucide="eye" size="20" style="cursor:pointer; color:var(--text-sub);" onclick="togglePass('pass-conf')"></i></div></div>
                    <button type="button" class="btn-main" onclick="cadastrarReal()">Criar minha conta</button>
                </form>
                <p style="text-align:center; margin-top:25px; font-size:14px; color:var(--text-sub); font-weight:600; cursor:pointer;" onclick="navegar('view-inicio')">‚Üê Voltar</p>
            </div>
        </section>

        <section id="view-recuperar" class="view">
            <div class="auth-card">
                <div style="text-align: center; margin-bottom: 30px; font-size: 34px; font-weight: 900; letter-spacing: -1.5px;">FLEX<span>A</span></div>
                <h2 style="font-size: 20px; font-weight: 800; margin-bottom: 10px; text-align: center;">Recuperar senha</h2>
                <div class="form-group">
                    <label>E-mail</label>
                    <div class="input-wrapper"><i data-lucide="mail" size="20"></i><input type="email" placeholder="seuemail@exemplo.com"></div>
                </div>
                <button type="button" class="btn-main">Enviar Link de Recupera√ß√£o</button>
                <p style="text-align:center; margin-top:25px; font-size:14px; color:var(--text-sub); font-weight:600; cursor:pointer;" onclick="navegar('view-auth')">‚Üê Voltar ao login</p>
            </div>
        </section>

        <section id="view-dash-loja" class="view">
            <header class="header-dash">
                <div class="logo">FLEX<span>A</span></div>
                <div style="display:flex; align-items:center; gap:15px;"><i data-lucide="bell" size="24"></i><img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100" class="profile-img"></div>
            </header>
            <div id="dash-loader-content">
                <h2 class="skeleton" style="font-size: 24px; font-weight: 800; margin-bottom: 25px; width: 80%;">Ol√°, Express Imports! üëã</h2>
                <div class="promo-banner skeleton" style="height: 120px;"></div>
                <div class="grid-stats">
                    <div class="stat-card skeleton" style="height: 90px;"></div>
                    <div class="stat-card skeleton" style="height: 90px;"></div>
                </div>
                <div class="rota-card skeleton" style="height: 80px;"></div>
            </div>
        </section>

        <section id="view-novo-envio" class="view">

    <div id="envio-p1">
        <h2 style="font-size: 24px; font-weight: 900; margin-bottom: 30px; letter-spacing: -1px;">Para quem enviar?</h2>
        
        <div class="form-group">
            <label>WhatsApp do Cliente</label>
            <div class="input-wrapper">
                <i data-lucide="search" size="20" style="color:#94a3b8"></i>
                <input type="tel" placeholder="Buscar por n√∫mero...">
            </div>
        </div>

        <span style="font-size: 11px; font-weight: 800; color: #94a3b8; text-transform: uppercase; margin-bottom: 15px; display: block;">Clientes Frequentes</span>

        <div class="swipe-container" id="container-maria">
            <div class="swipe-action-delete">
                <i data-lucide="trash-2" size="20"></i>
                <span>Excluir</span>
            </div>
            
            <div class="cliente-card-simples" 
                 id="card-maria"
                 onclick="irParaPasso2('Maria Silva', 'Rua das Flores, 123 - Aldeota', '(85) 99876-5432')"
                 ontouchstart="handleTouchStart(event)" 
                 ontouchmove="handleTouchMove(event)" 
                 ontouchend="handleTouchEnd(event)"
                 style="position: relative; z-index: 2; margin-bottom: 0 !important;">
                 
                <span class="badge-freq">Frequente</span>
                <strong style="font-size: 17px; font-weight: 800; display: block; margin-bottom: 2px;">Maria Silva</strong>
                <span style="font-size: 14px; color: #64748b; display: block;">Rua das Flores, 123 - Aldeota</span>
                
                <span style="color: var(--brand-orange); font-size: 13px; font-weight: 700; display: flex; align-items: center; gap: 6px; margin-top: 6px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 448 512" fill="currentColor"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.1 0-65.6-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-5.5-2.8-23.2-8.5-44.2-27.1-16.4-14.6-27.4-32.7-30.6-38.2-3.2-5.6-.3-8.6 2.5-11.3 2.5-2.5 5.6-6.5 8.3-9.7 2.8-3.3 3.7-5.6 5.6-9.3 1.9-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 13.2 5.8 23.5 9.2 31.5 11.8 13.3 4.2 25.4 3.6 35 2.2 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
                    (85) 99876-5432
                </span>
            </div>
        </div>

        <div style="margin-top: 40px;">
            <button class="btn-outline" onclick="abrirNovoCliente()" style="height: 62px; font-size: 16px;">
                + Novo Cliente
            </button>
            <p style="text-align:center; margin-top:20px; font-size:14px; color:var(--text-sub); font-weight:700; cursor:pointer;" onclick="navegar('view-dash-loja')">‚Üê Voltar</p>
        </div>
    </div> <div id="envio-p2" class="hidden">
        <div style="display:flex; align-items:center; gap:15px; margin-bottom:25px;">
            <i data-lucide="arrow-left" size="24" onclick="voltarParaPasso(1)" style="cursor:pointer"></i>
            <h2 class="screen-title">Detalhes do Envio</h2>
        </div>

        <div class="destinatario-card">
            <span class="destinatario-label">Destinat√°rio</span>
            <strong class="destinatario-nome" id="card-nome">---</strong>
            <span class="destinatario-info" id="card-endereco">---</span>
            <span style="color: var(--brand-orange); font-size: 13px; font-weight: 700; display: flex; align-items: center; gap: 6px; margin-top: 6px;">
                <i data-lucide="phone" size="14"></i>
                <span id="card-whatsapp">---</span>
            </span>
        </div>

<div class="form-group">
                    <span class="section-title">O que est√° enviando?</span>
                    <div class="input-wrapper">
                        <input type="text" id="input-desc" placeholder="Ex: 2 camisas e 1 cal√ßa">
                    </div>
                </div>

                <div class="form-group">
                    <span class="section-title">Valor Total (R$)</span>
                    <div class="input-wrapper">
                        <span style="font-size: 20px; font-weight: 400; color: #0f172a; margin-right: 5px;">R$</span>
                        <input type="number" id="input-valor" placeholder="150,00">
                    </div>
                </div>

        <span class="section-title">Tipo de Servi√ßo</span>
        <div class="selection-grid">
            <div class="select-box active" id="srv-std" onclick="selecionarServico('Standard')">
                <i data-lucide="truck" size="24"></i>
                <strong>Standard</strong>
                <span>At√© 24h</span>
            </div>
            <div class="select-box" id="srv-flash" onclick="selecionarServico('Flash')">
                <i data-lucide="zap" size="24"></i>
                <strong>Flash</strong>
                <span>At√© 2h</span>
            </div>
        </div>

        <span class="section-title">Tamanho do Volume</span>
        <div class="selection-grid-3">
            <div class="select-box active" id="sz-p" onclick="selecionarTamanho('P')">
                <strong>P</strong>
                <span>At√© 2kg</span>
            </div>
            <div class="select-box" id="sz-m" onclick="selecionarTamanho('M')">
                <strong>M</strong>
                <span>At√© 5kg</span>
            </div>
            <div class="select-box" id="sz-g" onclick="selecionarTamanho('G')">
                <strong>G</strong>
                <span>At√© 10kg</span>
            </div>
        </div>

        <button class="btn-main" onclick="irParaVeiculos()">Op√ß√µes de envio</button>
    </div> <div id="envio-p3" class="hidden">
        <div style="display:flex; align-items:center; gap:15px; margin-bottom:25px;">
            <i data-lucide="arrow-left" size="24" onclick="voltarParaPasso(1)" style="cursor:pointer"></i>
            <h2 class="screen-title">Novo Cliente</h2>
        </div>

        <div style="display: flex; flex-direction: column; gap: 15px;">
            <div class="form-group" style="margin-bottom: 0;">
                <label>Nome do Cliente</label>
                <div class="input-wrapper"><i data-lucide="user" size="20"></i><input type="text" id="new-cli-nome" placeholder="Nome completo"></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>WhatsApp</label>
                <div class="input-wrapper"><i data-lucide="phone" size="20"></i><input type="tel" id="new-cli-tel" placeholder="(00) 00000-0000" maxlength="15"></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>CEP</label>
                <div style="display: flex; gap: 8px;">
                    <div class="input-wrapper" style="flex: 1;"><i data-lucide="map" size="20"></i><input type="text" id="new-cli-cep" placeholder="00000-000" maxlength="9"></div>
                    <button onclick="buscarEndereco()" style="background: var(--brand-orange); color: white; border: none; border-radius: 16px; width: 60px; display: flex; align-items: center; justify-content: center;"><i data-lucide="search"></i></button>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>Rua / Logradouro</label>
                <div class="input-wrapper"><input type="text" id="new-cli-rua" placeholder="Ex: Av. Paulista"></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>N√∫mero</label>
                <div class="input-wrapper"><input type="text" id="new-cli-num" placeholder="Ex: 123 ou S/N"></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>Bairro</label>
                <div class="input-wrapper"><input type="text" id="new-cli-bairro" placeholder="Digite o bairro"></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>Cidade</label>
                <div class="input-wrapper" style="background: #f8fafc;"><input type="text" id="new-cli-cidade" placeholder="Cidade" readonly></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>Estado (UF)</label>
                <div class="input-wrapper" style="background: #f8fafc;"><input type="text" id="new-cli-estado" placeholder="UF" readonly></div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
                <label>Complemento</label>
                <div class="input-wrapper"><input type="text" id="new-cli-comp" placeholder="Apto, Bloco, Sala..."></div>
            </div>

            <div class="form-group" style="margin-bottom: 10px;">
                <label>Observa√ß√£o (Opcional)</label>
                <div class="input-wrapper"><input type="text" id="new-cli-obs" placeholder="Ex: Pr√≥ximo ao mercado"></div>
            </div>
        </div>

        <button class="btn-main" onclick="salvarNovoCliente()" style="margin-top: 10px;">Salvar e Continuar</button>
        <p style="text-align:center; margin-top:20px; font-size:14px; color:var(--text-sub); font-weight:700; cursor:pointer;" onclick="voltarParaPasso(1)">Cancelar</p>
    </div> <div id="envio-v-veiculo" class="hidden">
        <div style="display:flex; align-items:center; gap:15px; margin-bottom:25px;">
            <i data-lucide="arrow-left" size="24" onclick="voltarParaPasso(2)" style="cursor:pointer"></i>
            <h2 class="screen-title">Escolha o transporte</h2>
        </div>

        <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 30px;">
            <div class="veiculo-item" id="v-patinete" onclick="selecionarVeiculo('Patinete', 'R$ 6,50')">
                <div class="veiculo-icon"><i data-lucide="toy-brick"></i></div>
                <div class="veiculo-info">
                    <strong>Patinete Flexa</strong>
                    <span>At√© 1kg ‚Ä¢ 20x20x10cm</span>
                </div>
                <div class="veiculo-preco">R$ 6,50</div>
            </div>

            <div class="veiculo-item" id="v-bike" onclick="selecionarVeiculo('Bicicleta', 'R$ 8,90')">
                <div class="veiculo-icon"><i data-lucide="bike"></i></div>
                <div class="veiculo-info">
                    <strong>Bicicleta</strong>
                    <span>At√© 3kg ‚Ä¢ 30x30x20cm</span>
                </div>
                <div class="veiculo-preco">R$ 8,90</div>
            </div>

            <div class="veiculo-item active" id="v-moto" onclick="selecionarVeiculo('Moto', 'R$ 12,50')">
                <div class="veiculo-icon"><i data-lucide="motorcycle"></i></div>
                <div class="veiculo-info">
                    <strong>Moto Flexa</strong>
                    <span>At√© 10kg ‚Ä¢ 40x40x40cm</span>
                </div>
                <div class="veiculo-preco">R$ 12,50</div>
            </div>

            <div class="veiculo-item" id="v-carro" onclick="selecionarVeiculo('Carro', 'R$ 18,00')">
                <div class="veiculo-icon"><i data-lucide="car"></i></div>
                <div class="veiculo-info">
                    <strong>Carro</strong>
                    <span>At√© 50kg ‚Ä¢ Porta-malas</span>
                </div>
                <div class="veiculo-preco">R$ 18,00</div>
            </div>

            <div class="veiculo-item" id="v-van" onclick="selecionarVeiculo('Van', 'R$ 45,00')">
                <div class="veiculo-icon"><i data-lucide="truck"></i></div>
                <div class="veiculo-info">
                    <strong>Flexa Van</strong>
                    <span>At√© 200kg ‚Ä¢ Grandes volumes</span>
                </div>
                <div class="veiculo-preco">R$ 45,00</div>
            </div>
        </div>

        <button class="btn-main" onclick="irParaRevisao()">Confirmar Ve√≠culo</button>
    </div> <div id="envio-p4" class="hidden">
        <div style="display:flex; align-items:center; gap:15px; margin-bottom:25px;">
            <i data-lucide="arrow-left" size="24" onclick="voltarParaPasso(2)" style="cursor:pointer"></i>
            <h2 class="screen-title">Revisar Envio</h2>
        </div>

        <div class="destinatario-card" style="border: 2px solid var(--brand-orange); background: #fffaf5;">
            <span class="destinatario-label">Destino</span>
            <strong class="destinatario-nome" id="rev-nome">Maria Silva</strong>
            <span class="destinatario-info" id="rev-end">Rua das Flores, 123</span>
        </div>

        <div style="background: white; padding: 20px; border-radius: 24px; margin-bottom: 20px; border: 1px solid var(--border-color);">
            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                <span style="color:var(--text-sub); font-weight:600;">Servi√ßo</span>
                <strong id="rev-servico">Standard</strong>
            </div>
            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                <span style="color:var(--text-sub); font-weight:600;">Tamanho</span>
                <strong id="rev-tamanho">Pacote P</strong>
            </div>
            <div style="display:flex; justify-content:space-between; padding-top:15px; border-top:1px dashed #e2e8f0;">
                <span style="color:var(--text-main); font-weight:800;">Total do Frete</span>
                <strong style="color:var(--brand-orange); font-size:20px;">R$ 12,50</strong>
            </div>
        </div>

        <button class="btn-main" onclick="confirmarEnvioFinal()" style="background:var(--brand-orange);">
            Criar Envio
        </button>
        <p style="text-align:center; margin-top:20px; font-size:14px; color:var(--text-sub); font-weight:700; cursor:pointer;" onclick="voltarParaPasso(2)">Ajustar detalhes</p>
    </div> <div id="envio-p5" class="hidden" style="text-align: center; padding-top: 50px;">
        <div style="width: 100px; height: 100px; background: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px; box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);">
            <i data-lucide="check" size="50" style="color: white;"></i>
        </div>
        
        <h2 class="screen-title" style="margin-bottom: 10px;">Pedido Solicitado!</h2>
        <p style="color: var(--text-sub); margin-bottom: 40px; padding: 0 20px;">
            O motorista mais pr√≥ximo j√° foi notificado e est√° a caminho para a coleta.
        </p>

        <div style="background: #f8fafc; border-radius: 20px; padding: 20px; margin-bottom: 40px; border: 1px solid var(--border-color);">
            <span style="display:block; font-size:12px; color:var(--text-sub); text-transform:uppercase; font-weight:700; margin-bottom:5px;">C√≥digo do Pedido</span>
            <strong style="font-size:20px; color:var(--text-main);">#FX-8829</strong>
        </div>

        <button class="btn-main" onclick="navegar('view-dash-loja')">Voltar para o In√≠cio</button>
    </div> </section>
	
	<section id="view-perfil" class="view">
    <div class="header-perfil" style="padding: 20px; margin-bottom: 20px;">
        <h2 style="font-size: 24px; font-weight: 900; letter-spacing: -1px;">Meu Perfil</h2>
    </div>

    <div class="perfil-container" style="padding: 0 20px;">
        <div class="logo-upload-section" style="text-align: center; margin-bottom: 30px; background: white; padding: 30px; border-radius: 24px; border: 1px solid var(--border-color);">
            <div class="logo-wrapper" onclick="document.getElementById('file-input').click()" style="position: relative; width: 100px; height: 100px; margin: 0 auto 15px; cursor: pointer;">
                <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100" id="logo-perfil-display" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 3px solid var(--brand-orange);">
                <div style="position: absolute; bottom: 0; right: 0; background: var(--brand-orange); color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border: 2px solid white;">
                    <i data-lucide="camera" size="16"></i>
                </div>
            </div>
            <input type="file" id="file-input" style="display:none" accept="image/*" onchange="uploadLogo(this)">
            <h3 id="perfil-nome-loja" style="font-weight: 800; font-size: 20px; margin: 0;">Nome da Loja</h3>
            <span style="color: var(--text-sub); font-size: 14px;">Membro desde 2024</span>
        </div>

        <div class="perfil-menu" style="display: flex; flex-direction: column; gap: 12px;">
            <div class="menu-item" style="background: white; padding: 18px; border-radius: 20px; display: flex; align-items: center; gap: 15px; border: 1px solid var(--border-color); cursor: pointer;">
                <div style="background: #f1f5f9; width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: var(--text-main);">
                    <i data-lucide="user" size="20"></i>
                </div>
                <div style="flex: 1;">
                    <strong style="display: block; font-size: 16px;">Dados da Conta</strong>
                    <span style="font-size: 12px; color: var(--text-sub);">E-mail, CNPJ e Senha</span>
                </div>
                <i data-lucide="chevron-right" size="18" style="color: #cbd5e1;"></i>
            </div>

            <div class="menu-item" style="background: white; padding: 18px; border-radius: 20px; display: flex; align-items: center; gap: 15px; border: 1px solid var(--border-color); cursor: pointer;">
                <div style="background: #f1f5f9; width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: var(--text-main);">
                    <i data-lucide="credit-card" size="20"></i>
                </div>
                <div style="flex: 1;">
                    <strong style="display: block; font-size: 16px;">Pagamentos</strong>
                    <span style="font-size: 12px; color: var(--text-sub);">Cart√µes e hist√≥rico</span>
                </div>
                <i data-lucide="chevron-right" size="18" style="color: #cbd5e1;"></i>
            </div>
        </div>

        <button class= "btn-logout" onclick="logoutReal()" style="width: 100%; margin-top: 40px; background: #fee2e2; color: #ef4444; border: none; padding: 18px; border-radius: 20px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer;">
            <i data-lucide="log-out" size="20"></i> Sair da Conta
        </button>
    </div>
</section>

<section id="view-rotas" class="view">
    <header style="padding: 10px 0 15px; display: flex; justify-content: space-between; align-items: center;">
        <div class="location-group">
            <span style="font-size: 11px; color: var(--text-sub); font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px;">Local de Coleta</span>
            <h2 style="font-size: 18px; color: var(--text-main); font-weight: 800; display: flex; align-items: center; gap: 5px;">
                Maracana√∫, CE <i data-lucide="chevron-down" size="18" style="color: var(--brand-orange)"></i>
            </h2>
        </div>
        <div class="notif-badge" style="width: 45px; height: 45px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05); position: relative;">
            <i data-lucide="bell" size="22"></i>
            <div class="dot" style="width: 8px; height: 8px; background: var(--brand-orange); border-radius: 50%; position: absolute; top: 12px; right: 12px; border: 2px solid white;"></div>
        </div>
    </header>

    <div class="filter-container">
        <div class="filter-scroll" style="display: flex; gap: 12px; overflow-x: auto;  padding-bottom: 5px; -webkit-overflow-scrolling: touch;">
            <div style="background: var(--brand-orange);" class="chip active"><i data-lucide="plus-circle" size="16"></i> Nova Rota</div>
            <div class="chip">Rastrear</div>
            <div class="chip">Em Aberto</div>
            <div class="chip">Finalizadas</div>
            <div class="chip">Pendentes</div>
        </div>
    </div>

    <div class="hero-card" style="background: white; margin: 0 0 25px; padding: 35px 20px; border-radius: 28px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.02);">
        <button class="main-add-btn" onclick="openModal()" style="width: 70px; height: 70px; background: linear-gradient(135deg, var(--brand-orange), #FF8E64); border-radius: 50%; border: none; color: white; margin-bottom: 15px; box-shadow: 0 10px 20px rgba(255,107,53,0.3); cursor: pointer; display: inline-flex; align-items: center; justify-content: center;">
            <i data-lucide="plus" size="32"></i>
        </button>
        <h3 style="font-size: 20px; font-weight: 800;">Adicionar Rota</h3>
        <p style="color: var(--text-sub); font-size: 14px; margin-top: 6px;">Crie uma nova rota para seus entregadores</p>
    </div>

    <div class="list-header" style="display: flex; justify-content: space-between; padding: 0 5px 15px; font-weight: 800; font-size: 16px; align-items: center;">
    <span>Rotas aguardando</span>
    
    <a href="#" onclick="verTodasAsRotas()" style="text-decoration: none; color: var(--brand-orange); font-size: 13px; font-weight: 700;">
        Ver todas
    </a>
</div>


    <div class="routes-list" style="padding: 0;">
        <div class="route-card" style="background: white; padding: 16px; border-radius: 20px; display: flex; align-items: center; gap: 15px; margin-bottom: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.02);">
            <div class="icon-box" style="width: 50px; height: 50px; background: #F1F3F5; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: var(--text-main);">
                <i data-lucide="package" size="24"></i>
            </div>
            <div class="route-info" style="flex: 1;">
                <h4 style="font-size: 14px; font-weight: 700; margin-bottom: 3px;">ID: R5422109</h4>
                <p style="font-size: 12px; color: var(--text-sub); font-weight: 500;">Mec Mini M4 Pro ‚Ä¢ 1.2km de voc√™</p>
            </div>
            <div class="status-tag" style="padding: 6px 10px; border-radius: 8px; font-size: 10px; font-weight: 800; background: #FFF0EB; color: var(--brand-orange); text-transform: uppercase;">BUSCANDO</div>
        </div>

        <div class="route-card" style="background: white; padding: 16px; border-radius: 20px; display: flex; align-items: center; gap: 15px; margin-bottom: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.02);">
            <div class="icon-box" style="width: 50px; height: 50px; background: #F1F3F5; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: var(--text-main);">
                <i data-lucide="package" size="24"></i>
            </div>
            <div class="route-info" style="flex: 1;">
                <h4 style="font-size: 14px; font-weight: 700; margin-bottom: 3px;">ID: R37883809</h4>
                <p style="font-size: 12px; color: var(--text-sub); font-weight: 500;">Drone DJI Neo ‚Ä¢ 0.8km de voc√™</p>
            </div>
            <div class="status-tag" style="padding: 6px 10px; border-radius: 8px; font-size: 10px; font-weight: 800; background: #FFF0EB; color: var(--brand-orange); text-transform: uppercase;">BUSCANDO</div>
        </div>
    </div>
</section>


<div class="modal-overlay" id="overlay-rota" onclick="closeModal()" style="position: fixed; inset: 0; background: rgba(0,0,0,0.4); display: none; z-index: 1100; backdrop-filter: blur(4px); align-items: flex-end;">
    <div class="modal-sheet" id="sheet-rota" onclick="event.stopPropagation()" style="width: 100%; background: white; border-radius: 30px 30px 0 0; padding: 35px 25px 50px; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);">
        <div class="modal-handle" style="width: 40px; height: 4px; background: #E9ECEF; border-radius: 10px; margin: -15px auto 25px;"></div>
        <h2 style="font-size: 22px; font-weight: 800; margin-bottom: 10px;">Op√ß√µes de Entrega</h2>
        <p style="color: var(--text-sub); margin-bottom: 25px; font-size: 15px;">Selecione como deseja criar sua rota no Flexa.</p>
        
        <div style="display: grid; gap: 12px;">
            <button style="width: 100%; padding: 20px; background: var(--brand-orange); color: white; border: none; border-radius: 18px; font-weight: 700; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer;">
                <i data-lucide="zap" size="20"></i> Rota Expressa
            </button>
            <button style="width: 100%; padding: 20px; background: #F1F3F5; color: var(--text-main); border: none; border-radius: 18px; font-weight: 700; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer;">
                <i data-lucide="calendar" size="20"></i> Agendar Rota
            </button>
        </div>
    </div>
</div>


   <nav id="main-nav" style="display: none;">
    <a href="#" class="nav-item active" onclick="navegar('view-dash-loja')">
        <i data-lucide="home"></i>
        <span>In√≠cio</span>
    </a>

    <a href="#" class="nav-item" onclick="navegar('view-rotas')">
        <i data-lucide="map"></i>
        <span>Rotas</span>
    </a>

    <div class="nav-center-plus" onclick="navegar('view-novo-envio')">
        <i data-lucide="plus" size="32"></i>
    </div>

    <a href="#" class="nav-item" onclick="alert('Chat em breve')">
        <i data-lucide="message-circle"></i>
        <span>Chat</span>
    </a>

    <a href="#" class="nav-item" onclick="irParaPerfil()">
        <i data-lucide="user"></i>
        <span>Perfil</span>
    </a>
</nav>


    <script>
const firebaseConfig = {
  apiKey: "AIzaSyBNsTcLawc8VaILryw36F5Iv6tIK0N41Og",
  authDomain: "flexa-app-41205.firebaseapp.com",
  projectId: "flexa-app-41205",
  storageBucket: "flexa-app-41205.firebasestorage.app",
  messagingSenderId: "1008393678489",
  appId: "1:1008393678489:web:8b9df090ef4695d6d6d208"
};
// Inicializa o Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();

// Vari√°vel para controle do usu√°rio logado
let usuarioLogado = null;

        lucide.createIcons();

        function navegar(idTela) {
    // 1. L√ìGICA ORIGINAL: Troca de telas
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById(idTela).classList.add('active');
    
    // 2. L√ìGICA ORIGINAL: Limpeza do formul√°rio de envio (MANTIDA)
    if (idTela !== 'view-novo-envio') {
        const passos = ['envio-p1', 'envio-p2', 'envio-p3', 'envio-p4', 'envio-p5', 'envio-v-veiculo'];
        passos.forEach(id => {
            const el = document.getElementById(id);
            if(el) el.classList.add('hidden');
        });
        const p1 = document.getElementById('envio-p1');
        if(p1) p1.classList.remove('hidden');
    }

    // 3. CONTROLE DE EXIBI√á√ÉO DO MENU (MANTIDO E AJUSTADO)
    const nav = document.getElementById('main-nav');
    if(['view-dash-loja', 'view-novo-envio', 'view-rotas', 'view-perfil'].includes(idTela)) {
        nav.style.display = 'flex';
    } else {
        nav.style.display = 'none';
    }

    // 4. NOVA L√ìGICA: Atualizar visual dos √≠cones (ATIVO/INATIVO)
    // Remove a classe 'active' de todos os itens do menu
    document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
    
    // Adiciona 'active' no √≠cone correspondente √† tela atual
    if(idTela === 'view-dash-loja') document.querySelector('.nav-item:nth-child(1)').classList.add('active');
    if(idTela === 'view-rotas') document.querySelector('.nav-item:nth-child(2)').classList.add('active');
    // O item 3 √© o bot√£o +, ele n√£o precisa de classe active
    if(idTela === 'view-chat') document.querySelector('.nav-item:nth-child(4)').classList.add('active');
    if(idTela === 'view-perfil') document.querySelector('.nav-item:nth-child(5)').classList.add('active');
    
    window.scrollTo(0,0);
    
    // Re-renderiza os √≠cones do Lucide para garantir que apare√ßam
    if(typeof lucide !== 'undefined') lucide.createIcons();
}

async function buscarEndereco() {
    const cepField = document.getElementById('new-cli-cep');
    const cep = cepField.value.replace(/\D/g, '');

    if (cep.length === 8) {
        try {
            const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
            const data = await response.json();

            if (!data.erro) {
                document.getElementById('new-cli-rua').value = data.logradouro || '';
                document.getElementById('new-cli-bairro').value = data.bairro || '';
                document.getElementById('new-cli-cidade').value = data.localidade || '';
                document.getElementById('new-cli-estado').value = data.uf || '';
                // Foca no n√∫mero automaticamente para agilizar
                document.getElementById('new-cli-num').focus();
            } else {
                alert("CEP n√£o encontrado.");
            }
        } catch (error) {
            console.error("Erro na busca:", error);
        }
    }
}




        function irParaCadastro(tipo) {
            navegar('view-auth');
            const groupCNH = document.getElementById('group-cnh');
            const inputNome = document.getElementById('input-nome');
            document.getElementById('label-nome').innerText = tipo === 'loja' ? "Nome da loja" : "Nome completo";
            inputNome.placeholder = tipo === 'loja' ? "Digite o nome da loja" : "Seu nome completo";
            tipo === 'loja' ? groupCNH.classList.add('hidden') : groupCNH.classList.remove('hidden');
            alternarAuth('entrar');
        }

        /* L√ìGICA DE PASSOS DO ENVIO */
        function irParaPasso2(nome, endereco, whats) {
    const p1 = document.getElementById('envio-p1');
    const p2 = document.getElementById('envio-p2');

    // Preenche os dados
    document.getElementById('card-nome').innerText = nome;
    document.getElementById('card-endereco').innerText = endereco;
    document.getElementById('card-whatsapp').innerText = whats;

    // Troca as telas com anima√ß√£o
    p1.classList.add('hidden');
    p2.classList.remove('hidden');
    p2.classList.add('fade-step'); // Adiciona o efeito suave

    window.scrollTo(0,0);
    
    // Remove a classe ap√≥s a anima√ß√£o para poder repetir depois
    setTimeout(() => p2.classList.remove('fade-step'), 400);
}

function voltarParaPasso(p) {
    // Esconde absolutamente todos os passos de envio para n√£o encavalar
    const todosPassos = ['envio-p1', 'envio-p2', 'envio-p3', 'envio-p4', 'envio-p5', 'envio-v-veiculo'];
    todosPassos.forEach(id => {
        const el = document.getElementById(id);
        if(el) el.classList.add('hidden');
    });

    // Mostra apenas o destino solicitado
    const destino = document.getElementById('envio-p' + p);
    if(destino) {
        destino.classList.remove('hidden');
        destino.classList.add('fade-step'); 
        setTimeout(() => destino.classList.remove('fade-step'), 400);
    }
    window.scrollTo(0,0);
}

        function selecionarServico(tipo) {
            document.getElementById('srv-std').classList.remove('active');
            document.getElementById('srv-flash').classList.remove('active');
            const id = tipo === 'Standard' ? 'srv-std' : 'srv-flash';
            document.getElementById(id).classList.add('active');
        }

        function selecionarTamanho(tam) {
            document.getElementById('sz-p').classList.remove('active');
            document.getElementById('sz-m').classList.remove('active');
            document.getElementById('sz-g').classList.remove('active');
            document.getElementById('sz-' + tam.toLowerCase()).classList.add('active');
        }

        /* L√ìGICA AUTH ORIGINAL */
        function togglePass(id) {
            const input = document.getElementById(id);
            input.type = input.type === 'password' ? 'text' : 'password';
        }
        function alternarAuth(modo) {
            const fCad = document.getElementById('form-cadastrar'), fEnt = document.getElementById('form-entrar');
            const tCad = document.getElementById('tab-cadastrar'), tEnt = document.getElementById('tab-entrar');
            if (modo === 'cadastrar') {
                fCad.classList.remove('hidden'); fEnt.classList.add('hidden');
                tCad.classList.add('active'); tEnt.classList.remove('active');
            } else {
                fEnt.classList.remove('hidden'); fCad.classList.add('hidden');
                tEnt.classList.add('active'); tCad.classList.remove('active');
            }
        }

function confirmarEnvioFinal() {
    // Esconde a revis√£o
document.getElementById('envio-v-veiculo').classList.add('hidden');    
document.getElementById('envio-p4').classList.add('hidden');
    
    // Mostra o sucesso
    const p5 = document.getElementById('envio-p5');
    p5.classList.remove('hidden');
    p5.classList.add('fade-step');
    
    window.scrollTo(0,0);
    lucide.createIcons();
}

function abrirNovoCliente() {
    document.getElementById('envio-p1').classList.add('hidden');
    const p3 = document.getElementById('envio-p3');
    p3.classList.remove('hidden');
    p3.classList.add('fade-step');
    window.scrollTo(0,0);
    lucide.createIcons();
}

// --- M√ÅSCARAS DE INPUT ---
document.getElementById('new-cli-tel').addEventListener('input', function (e) {
    let x = e.target.value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,5})(\d{0,4})/);
    e.target.value = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');
});

document.getElementById('new-cli-cep').addEventListener('input', function (e) {
    let x = e.target.value.replace(/\D/g, '').match(/(\d{0,5})(\d{0,3})/);
    e.target.value = !x[2] ? x[1] : x[1] + '-' + x[2];
});

// --- FUN√á√ÉO SALVAR √öNICA E CORRIGIDA ---
function salvarNovoCliente() {
    const nome = document.getElementById('new-cli-nome').value;
    const tel = document.getElementById('new-cli-tel').value;
    const rua = document.getElementById('new-cli-rua').value;
    const num = document.getElementById('new-cli-num').value;
    const bairro = document.getElementById('new-cli-bairro').value;
    const cidade = document.getElementById('new-cli-cidade').value;
    const estado = document.getElementById('new-cli-estado').value;
    const comp = document.getElementById('new-cli-comp').value;

    if(nome && tel && rua && num) {
        // Formata o endere√ßo para a tela de detalhes
        const enderecoCompleto = `${rua}, ${num} - ${bairro}, ${cidade}/${estado}${comp ? ' ('+comp+')' : ''}`;
        
        // Abre a tela de detalhes (P2) que restauramos acima
        irParaPasso2(nome, enderecoCompleto, tel);
        
        // Esconde o formul√°rio
        document.getElementById('envio-p3').classList.add('hidden');
        
        // Limpa os campos
        document.querySelectorAll('#envio-p3 input').forEach(input => input.value = '');
    } else {
        alert("Por favor, preencha Nome, WhatsApp, Rua e N√∫mero.");
    }
}


        function simularLogin() {
            navegar('view-dash-loja');
                        setTimeout(() => {
                document.getElementById('dash-loader-content').innerHTML = `
                    <h2 style="font-size: 24px; font-weight: 800; margin-bottom: 25px;">Ol√°, Express Imports! üëã</h2>
                    <div class="promo-banner"><h3>Est√° com pressa?</h3><p>Experimente o envio <b>Flash</b>.</p></div>
                    
                    <div class="grid-stats">
                        <div class="stat-card"><span>Entregas hoje</span><h4>12</h4></div>
                        <div class="stat-card"><span>Em tr√¢nsito</span><h4>4</h4></div>
                    </div>

                    <div class="filter-container">
                        <div class="chip active">Todas</div>
                        <div class="chip">Em rota</div>
                        <div class="chip">Pendentes</div>
                    </div>

                    <div class="rota-card">
                        <div class="rota-icon"><i data-lucide="package" size="22"></i></div>
                        <div class="rota-info">
                            <h5>Rota #8829</h5>
                            <p>4 pacotes ‚Ä¢ Fortaleza</p>
                        </div>
                        <span class="status-pill pill-em-rota">Em rota</span>
                    </div>
                `;
                lucide.createIcons();
            }, 1200);
        }
        // --- C√ìDIGO DO SWIPE (DESLIZAR) ---
        let touchStartX = 0;
        let activeCard = null;

        function handleTouchStart(e) {
            // Se o toque for no card da Maria, vamos rastrear
            touchStartX = e.touches[0].clientX;
            activeCard = e.currentTarget;
            activeCard.style.transition = 'none'; // Tira a anima√ß√£o enquanto o dedo move
        }

        function handleTouchMove(e) {
            if (!activeCard) return;
            let touchX = e.touches[0].clientX;
            let diff = touchX - touchStartX;
            
            // S√≥ deixa arrastar para a esquerda (diff negativo)
            // Limitamos em -150px para o card n√£o sair da tela totalmente sem querer
            if (diff < 0 && diff > -150) {
                activeCard.style.transform = `translateX(${diff}px)`;
            }
        }

                function handleTouchEnd(e) {
            if (!activeCard) return;
            activeCard.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            
            let touchX = e.changedTouches[0].clientX;
            let diff = touchX - touchStartX;

            // Se deslizou mais de 70px para a esquerda
            if (diff < -70) {
                // Faz o card sair da tela
                activeCard.style.transform = 'translateX(-120%)';
                
                // Guarda o ID para saber quem excluir
                const idParaDeletar = activeCard.id;
                
                // Chama a confirma√ß√£o ap√≥s o movimento de sa√≠da
                setTimeout(() => {
                    confirmarExclusao(idParaDeletar);
                }, 300);
            } else {
                // Volta para o lugar se deslizou pouco
                activeCard.style.transform = 'translateX(0)';
            }
            activeCard = null;
        }


                        function confirmarExclusao(cardId) {
            const card = document.getElementById(cardId);
            const container = card.parentElement;
            container.style.display = 'none';

            const toastAntigo = document.getElementById('toast-desfazer');
            if (toastAntigo) toastAntigo.remove();

            const toast = document.createElement('div');
            toast.className = 'undo-toast';
            toast.id = 'toast-desfazer';
            
            // Agora o clique funciona em qualquer lugar do toast
            toast.onclick = () => desfazerExclusao(cardId);

            let segundosRestantes = 10;

            toast.innerHTML = `
                <div class="undo-content">
                    <div class="undo-timer" id="timer-count">${segundosRestantes}</div>
                    <span style="font-size: 14px;">Cliente removido</span>
                </div>
                <div class="undo-btn">Desfazer</div>
            `;
            
            document.body.appendChild(toast);

            // L√≥gica do contador visual
            const interval = setInterval(() => {
                segundosRestantes--;
                const timerElement = document.getElementById('timer-count');
                if (timerElement) {
                    timerElement.innerText = segundosRestantes;
                }
                
                if (segundosRestantes <= 0) {
                    clearInterval(interval);
                    fecharToastSuave(toast);
                }
            }, 1000);

            // Guardamos o intervalo no elemento para limpar se o usu√°rio clicar antes
            toast.dataset.intervalId = interval;
        }

        function fecharToastSuave(elemento) {
            if (elemento) {
                elemento.style.opacity = '0';
                elemento.style.transition = 'opacity 0.5s ease-out';
                setTimeout(() => elemento.remove(), 1000);
            }
        }

        // Ajuste na fun√ß√£o de desfazer para limpar o contador
        function desfazerExclusao(cardId) {
            const toast = document.getElementById('toast-desfazer');
            if (toast) {
                clearInterval(toast.dataset.intervalId);
                toast.remove();
            }

            const card = document.getElementById(cardId);
            const container = card.parentElement;
            container.style.display = 'block';
            card.style.transform = 'translateX(0)';
        }



        function desfazerExclusao(cardId) {
            const card = document.getElementById(cardId);
            const container = card.parentElement;
            
            // Traz o container de volta e reseta o card para a posi√ß√£o original
            container.style.display = 'block';
            card.style.transform = 'translateX(0)';
            
            // Remove o aviso preto da tela imediatamente
            const aviso = document.getElementById('toast-desfazer');
            if (aviso) aviso.remove();
        }

let veiculoSelecionado = "Moto"; // Valor padr√£o

function selecionarVeiculo(tipo) {
    // Remove active de todos os ve√≠culos
    const ids = ['v-patinete', 'v-bike', 'v-moto', 'v-carro', 'v-van', 'v-drone'];
    ids.forEach(id => document.getElementById(id).classList.remove('active'));
    
    // Adiciona no selecionado
    const slug = tipo.toLowerCase().replace('padr√£o', '').trim(); // simplifica√ß√£o de ID se necess√°rio
    // Aqui usamos um mapeamento simples para os IDs que criamos:
    const mapaIds = {
        'Patinete': 'v-patinete', 'Bicicleta': 'v-bike', 'Moto': 'v-moto',
        'Carro': 'v-carro', 'Van': 'v-van', 'Drone': 'v-drone'
    };
    document.getElementById(mapaIds[tipo]).classList.add('active');
    veiculoSelecionado = tipo;
}

// Alterar o bot√£o da tela P2 para chamar esta fun√ß√£o:
function irParaVeiculos() {
    document.getElementById('envio-p2').classList.add('hidden');
    const telaV = document.getElementById('envio-v-veiculo');
    telaV.classList.remove('hidden');
    telaV.classList.add('fade-step');
    window.scrollTo(0,0);
    lucide.createIcons();
}

// Atualizar a fun√ß√£o de Revis√£o para incluir o ve√≠culo
function irParaRevisao() {
    const nome = document.getElementById('card-nome').innerText;
    const endereco = document.getElementById('card-endereco').innerText;
    
    // CORRE√á√ÉO AQUI: Adicionado 'envio-p2' para ele achar o servi√ßo e tamanho
    const servico = document.querySelector('#envio-p2 .select-box.active strong').innerText;
    const tamanho = document.querySelector('#envio-p2 .selection-grid-3 .select-box.active strong').innerText;

    document.getElementById('rev-nome').innerText = nome;
    document.getElementById('rev-end').innerText = endereco;
    document.getElementById('rev-servico').innerText = servico;
    document.getElementById('rev-tamanho').innerText = "Pacote " + tamanho + " ‚Ä¢ " + veiculoSelecionado;

    // Esconde a tela de ve√≠culos e mostra a revis√£o
    document.getElementById('envio-v-veiculo').classList.add('hidden');
    const p4 = document.getElementById('envio-p4');
    p4.classList.remove('hidden');
    p4.classList.add('fade-step');
    
    window.scrollTo(0,0);
    lucide.createIcons();
}
// Ativa o link de Rotas no menu inferior
document.querySelector('.nav-item:nth-child(2)').onclick = () => navegar('view-rotas');

function abrirCriarRota() {
    // Aqui simulamos que existem 3 envios pendentes no seu banco/mem√≥ria
    const pendentes = [
        { id: 1, cliente: "Maria Silva", preco: 12.50, flash: false },
        { id: 2, cliente: "Jo√£o Paulo", preco: 25.00, flash: true }, // Regra do Flash
        { id: 3, cliente: "Ana Beatriz", preco: 12.50, flash: false }
    ];

    const container = document.getElementById('selecao-envios');
    container.innerHTML = '';

    pendentes.forEach(envio => {
        const div = document.createElement('div');
        div.className = 'checkbox-envio';
        div.onclick = function() { 
            this.classList.toggle('selected');
            atualizarResumoRota();
        };
        div.innerHTML = `
            <div style="flex:1">
                <strong style="display:block">${envio.cliente}</strong>
                <span style="font-size:12px; color:var(--text-sub)">R$ ${envio.preco.toFixed(2)}</span>
                ${envio.flash ? '<span class="badge-flash">FLASH</span>' : ''}
            </div>
            <i data-lucide="circle"></i>
        `;
        container.appendChild(div);
    });
    
    document.getElementById('modal-criar-rota').classList.add('active');
    lucide.createIcons();
}

function fecharModalRota() {
    document.getElementById('modal-criar-rota').classList.remove('active');
}

function pagarComPix() {
    // Passo 3: Simula√ß√£o de Sucesso
    alert("Simulando Pagamento PIX...");
    setTimeout(() => {
        alert("Pagamento Confirmado!");
        fecharModalRota();
        navegar('view-rotas');
        // Aqui voc√™ adicionaria a l√≥gica de inserir na lista de rotas reais
    }, 1500);
}

function atualizarResumoRota() {
    const selecionados = document.querySelectorAll('.checkbox-envio.selected').length;
    document.getElementById('rota-qtd').innerText = selecionados;
    document.getElementById('rota-total').innerText = "R$ " + (selecionados * 12.50).toFixed(2); // Simula√ß√£o de pre√ßo
}

async function cadastrarReal() {
    const nome = document.getElementById('input-nome').value;
    const email = document.querySelector('#form-cadastrar input[type="email"]').value;
    const senha = document.getElementById('pass-cad').value;

    if (!nome || !email || !senha) return alert("Preencha todos os campos!");

    try {
        const cred = await auth.createUserWithEmailAndPassword(email, senha);
        
        // Salva os dados extras no Realtime Database
        await db.ref('usuarios/' + cred.user.uid).set({
            nome: nome,
            email: email,
            tipo: 'loja',
            criadoEm: Date.now()
        });

        alert("Conta criada com sucesso!");
        alternarAuth('entrar');
    } catch (error) {
        alert("Erro ao cadastrar: " + error.message);
    }
}    
async function loginReal() {
    const email = document.querySelector('#form-entrar input[type="email"]').value;
    const senha = document.getElementById('pass-login').value;

    if (!email || !senha) return alert("Preencha e-mail e senha!");

    try {
        const cred = await auth.signInWithEmailAndPassword(email, senha);
        const snapshot = await db.ref('usuarios/' + cred.user.uid).once('value');
        const dadosUser = snapshot.val();

        if (dadosUser) {
            usuarioLogado = { id: cred.user.uid, ...dadosUser };
            localStorage.setItem('flexa_session', JSON.stringify(usuarioLogado));
            
            // 1. Muda para a tela de Dash
            navegar('view-dash-loja');
            
            // 2. Preenche o Dashboard IMEDIATAMENTE (Parando o efeito de carregar)
            renderizarDashboard(usuarioLogado);
        }
    } catch (error) {
        alert("Erro ao entrar: " + error.message);
    }
}
// --- FUN√á√ÉO PARA IR AO PERFIL E CARREGAR DADOS ---
function irParaPerfil() {
    // 1. Ativa a visualiza√ß√£o
    navegar('view-perfil');
    
    // 2. Preenche os dados se o usu√°rio estiver logado
    if (usuarioLogado) {
        document.getElementById('perfil-nome-loja').innerText = usuarioLogado.nome || "Minha Loja";
        document.getElementById('perfil-email-loja').innerText = usuarioLogado.email || "";
        
        if (usuarioLogado.logo) {
            document.getElementById('img-perfil-display').src = usuarioLogado.logo;
        }
    }
    
    // 3. Renderiza os √≠cones da Lucide que acabaram de aparecer
    lucide.createIcons();
}
// --- FUN√á√ÉO DE LOGOUT ---
// 1. FUN√á√ÉO PARA LOGOUT
function logoutReal() {
    if (confirm("Tem certeza que deseja sair?")) {
        firebase.auth().signOut().then(() => {
            alert("Sess√£o encerrada!");
            // Limpa dados locais se houver e volta para a tela inicial
            localStorage.removeItem('flexa_user_data'); 
            window.location.reload(); // Recarrega para limpar o estado da aplica√ß√£o
        }).catch((error) => {
            alert("Erro ao sair: " + error.message);
        });
    }
}

// 2. MONITOR DE ESTADO DE AUTENTICA√á√ÉO (Persist√™ncia)
// Esta fun√ß√£o roda automaticamente sempre que a p√°gina abre ou o estado muda
// MONITOR DE ESTADO DE AUTENTICA√á√ÉO
firebase.auth().onAuthStateChanged((user) => {
    const tabbar = document.getElementById('main-nav');
    const splash = document.getElementById('splash-screen');

    if (user) {
        // Usu√°rio Logado
        firebase.database().ref('usuarios/' + user.uid).once('value')
            .then((snapshot) => {
                const userData = snapshot.val();
                if (userData) {
                    window.usuarioLogado = { id: user.uid, ...userData };
                    renderizarDashboard(userData);
                    navegar('view-dash-loja');
                    if (tabbar) tabbar.style.display = 'flex';
                }
                finalizarSplash(splash);
            }).catch(() => finalizarSplash(splash));
    } else {
        // Usu√°rio Deslogado
        navegar('view-inicio');
        if (tabbar) tabbar.style.display = 'none';
        finalizarSplash(splash);
    }
});

// Fun√ß√£o suave para esconder o splash
function finalizarSplash(elemento) {
    if (elemento) {
        elemento.style.opacity = '0';
        setTimeout(() => {
            elemento.style.display = 'none';
        }, 500); // Tempo da transi√ß√£o CSS
    }
}

// Fun√ß√£o suave para esconder o splash
function finalizarSplash(elemento) {
    if (elemento) {
        elemento.style.opacity = '0';
        setTimeout(() => {
            elemento.style.display = 'none';
        }, 500); // Tempo da transi√ß√£o CSS
    }
}

// 3. ATUALIZA√á√ÉO DA FUN√á√ÉO DE LOGIN EXISTENTE
// Certifique-se que sua fun√ß√£o loginReal() use o Firebase Auth corretamente
// O Firebase por padr√£o j√° usa 'local' persistence no browser.
function loginReal() {
    const email = document.querySelector('#form-entrar input[type="email"]').value;
    const senha = document.querySelector('#pass-login').value;

    if (!email || !senha) {
        alert("Preencha todos os campos!");
        return;
    }

    firebase.auth().signInWithEmailAndPassword(email, senha)
        .then((userCredential) => {
            // O onAuthStateChanged acima cuidar√° do redirecionamento
           
        })
        .catch((error) => {
            alert("Erro no login: " + error.message);
        });
}


// --- UPLOAD DE LOGO (BASE64) ---
function uploadLogo(input) {
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = async function(e) {
            const base64Image = e.target.result;
            document.getElementById('logo-perfil-display').src = base64Image;
            
            try {
                await db.ref('usuarios/' + usuarioLogado.id).update({ logo: base64Image });
                // Atualiza tamb√©m no Dashboard
                const logoDash = document.querySelector('.profile-img');
                if(logoDash) logoDash.src = base64Image;
                alert("Logo atualizada!");
            } catch (err) {
                alert("Erro ao salvar: " + err.message);
            }
        };
        reader.readAsDataURL(input.files[0]);
    }
}

function renderizarDashboard(user) {
    const container = document.getElementById('dash-loader-content');
    const fotoUrl = user.logo || 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100';
    
    // Atualiza a foto pequena no topo
    document.querySelector('.profile-img').src = fotoUrl;

    container.innerHTML = `
        <h2 style="font-size: 24px; font-weight: 800; margin-bottom: 25px;">Ol√°, ${user.nome}! üëã</h2>
        <div class="promo-banner">
            <h3>Est√° com pressa?</h3>
            <p>Experimente o envio <b>Flash</b>.</p>
        </div>
        
        <div class="grid-stats">
            <div class="stat-card"><span>Entregas hoje</span><h4>0</h4></div>
            <div class="stat-card"><span>Em tr√¢nsito</span><h4>0</h4></div>
        </div>

        <div class="filter-container">
            <div style="background: var(--brand-orange)" class="chip active">Todas</div>
            <div class="chip">Em rota</div>
            <div class="chip">Pendentes</div>
        </div>

        <div id="lista-vazia-dash" style="text-align:center; padding:20px; color:var(--text-sub);">
            <p>Nenhuma atividade recente.</p>
        </div>
    `;
    lucide.createIcons();
}
function buscarDadosDoBanco(uid) {
    db.ref('usuarios/' + uid).once('value') // Use 'db' aqui tamb√©m
        .then((snapshot) => {
            const dados = snapshot.val();
            if (dados) {
                // ADICIONE ESTA LINHA ABAIXO:
                window.usuarioLogado = { id: uid, ...dados }; 
                
                renderizarDashboard(dados); 
                navegar('view-dash-loja');
            } else {
                navegar('view-auth'); 
            }
        });
}
// Adicione ou substitua no seu <script>
const overlayRota = document.getElementById('overlay-rota');
const sheetRota = document.getElementById('sheet-rota');

function openModal() {
    overlayRota.style.display = 'flex';
    // Pequeno delay para permitir a transi√ß√£o CSS
    setTimeout(() => {
        sheetRota.classList.add('show');
    }, 10);
}

function closeModal() {
    sheetRota.classList.remove('show');
    setTimeout(() => {
        overlayRota.style.display = 'none';
    }, 400); // Tempo igual √† transi√ß√£o CSS
}

// Atualize a inicializa√ß√£o dos √≠cones caso necess√°rio
lucide.createIcons();


</script>
</body>
</html>
